

# Biophysical Model to Estimate SARS-CoV-2 RBD Fitness

![Overview](./paper/Fig1.png)

Supporting material for the paper ["Biophysical principles predict fitness of SARS-CoV-2 variants"](https://www.biorxiv.org/content/10.1101/2023.07.23.549087v3) ([bioRxiv](https://www.biorxiv.org/content/10.1101/2023.07.23.549087v3)). Figures and supplementary data for that paper are in the [paper/](./paper) directory.


Plots are generated by running various notebooks in the [code/](./code) directory:
- [main_logistic.ipynb](code/main_logistic.ipynb):Notebook to generate figure 2, fitting the biophysical model using population fitness and experimental measured $K_D$.
- [main_ML.ipynb](code/main_ML.ipynb):Notebook to generate figure 3, using ML-predicted $K_D$ to estimate RBD fitness. To run the code, please download the ESM embeddings from (https://zenodo.org/records/11267983)
- [main_epistasis.ipynb](code/main_epistasis.ipynb):Notebook to generate figure 4, investigating epistasis within the fitness landscape fitted by the biophysical model.
- [main_logistic_time.ipynb](code/main_logistic_time.ipynb):Notebook to generate the rolling window fitness comparison in figure 3. 


If you use the code or predictions please consider citing:

```
@article{
doi:10.1073/pnas.2314518121,
author = {Dianzhuo Wang  and Marian Huot  and Vaibhav Mohanty  and Eugene I. Shakhnovich },
title = {Biophysical principles predict fitness of SARS-CoV-2 variants},
journal = {Proceedings of the National Academy of Sciences},
volume = {121},
number = {23},
pages = {e2314518121},
year = {2024},
doi = {10.1073/pnas.2314518121},
URL = {https://www.pnas.org/doi/abs/10.1073/pnas.2314518121},
eprint = {https://www.pnas.org/doi/pdf/10.1073/pnas.2314518121},
}
```
For any questions, please email johnwang at g.harvard.edu